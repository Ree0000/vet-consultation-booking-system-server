// Prisma Schema for Vet Appointment System

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                  Int       @id @default(autoincrement())
  name                String
  email               String    @unique
  phone               String
  password            String
  resetPasswordToken  String?
  resetPasswordExpire DateTime?
  createdAt           DateTime  @default(now())
  updatedAt           DateTime  @updatedAt

  pets         Pet[]
  appointments Appointment[]

  @@map("users")
}

model Pet {
  id        Int      @id @default(autoincrement())
  userId    Int
  name      String
  species   String // Animal species (e.g., 'dog', 'cat', 'rabbit', 'bird', etc.)
  breed     String?
  age       Int?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user         User          @relation(fields: [userId], references: [id], onDelete: Cascade)
  appointments Appointment[]

  @@map("pets")
}

model Veterinarian {
  id             Int      @id @default(autoincrement())
  name           String
  specialization String?
  available      Boolean  @default(true)
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  appointments Appointment[]

  @@map("veterinarians")
}

model Appointment {
  id              Int      @id @default(autoincrement())
  userId          Int
  petId           Int
  vetId           Int
  appointmentDate DateTime
  appointmentTime String
  reason          String?
  paymentMethod   String // 'pay_now' or 'pay_later'
  status          String   @default("scheduled") // 'scheduled', 'completed', 'cancelled'
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  user User         @relation(fields: [userId], references: [id], onDelete: Cascade)
  pet  Pet          @relation(fields: [petId], references: [id], onDelete: Cascade)
  vet  Veterinarian @relation(fields: [vetId], references: [id], onDelete: Restrict)

  @@map("appointments")
}

model Admin {
  id        Int      @id @default(autoincrement())
  name      String
  email     String   @unique
  phone     String
  password  String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("admins")
}
